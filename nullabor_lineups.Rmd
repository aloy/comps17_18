---
title: "Untitled"
author: "Cari Comnick"
date: "2/27/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(nullabor)
library(ggplot2)
library(dplyr)
library(scagnostics)
library(tidyverse)
```

Pull 20 random plots of a single type, 1 signal, 19 noise, see if means work
```{r}
setwd("~/Comps/comps17_18/simulation_data")
scag <- read_csv("combined_scagnostics.csv")
```

```{r}
n <- 100
sims <- matrix(ncol=n,nrow=6)

for (a in 1:n){
  each <- matrix(ncol=1,nrow=6)
  medians <- NULL
  for (i in 1:length(unique(scag$model))){
    x1 <- which(scag$model == unique(scag$model)[i] & scag$signal == 1)
    y <- which(scag$model == unique(scag$model)[i] & scag$signal == 0)
    
    null <- sample(y, 19, replace = FALSE)
    signal <- sample(x1, 1, replace = FALSE)
    
    dat <- scag[c(null,signal),]
    dscags <- as.matrix(dat[,4:12], ncol=9)
    #means <- colMeans(dscags)
    x <- NULL
    
    for (j in 1:20){
      medians[i] <- c(medians, median(dscags[i,1:9]))
      medians <- as.data.frame(medians)
      #x <- c(x, (dist(rbind(dscags[j,],means))))
      x <- c(x, (dist(rbind(dscags[j,],medians))))
    }
    each[i,1] <- which(x == max(x))
  }
  sims[,a] <- each[,1] 
}

#how good was it? really bad for funnel and linear
for (k in 1:6){
  print(length(which(sims[k,] == 20))/n)
}
```

```{r}
scags1 <- read_csv("TS_Scagnostics.csv")
```
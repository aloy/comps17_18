---
title: "Scagnostic_Examples"
author: "Aidan Mullan"
date: "4/5/2018"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(MASS)
library(scagnostics)
library(tidyverse)
```


```{r, fig.height=4, fig.width=5}
#Outlying
set.seed(1)
n <- 100
mu1 <- 0; mu2 <- 0
sigma <- matrix(c(1, .3, .3, 1), 2)
xy1 <- mvrnorm(n, mu = c(mu1, mu2), Sigma = sigma)
scagnostics(xy1[,1], xy1[,2])$s[1] #.0524

xy2 <- mvrnorm(10, mu = c(10,10), Sigma = sigma)
xy2 <- rbind(xy1, xy2)
scagnostics(xy2[,1], xy2[,2])$s[1] #.5430

xy3 <- mvrnorm(2, mu = c(-10,-10), Sigma = sigma)
xy4 <- mvrnorm(2, mu = c(10, -10), Sigma = sigma)
xy4 <- rbind(xy1, xy3, xy4)
scagnostics(xy4[,1], xy4[,2])$s[1] #.976

par(mfrow = c(2,2))
plot(xy1[,1], xy1[,2], main = "Outlying: .052", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(xy2[,1], xy2[,2], main = "Outlying: .543", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(xy4[,1], xy4[,2], main = "Outlying: .976", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
```


```{r, fig.height=4, fig.width=5}
#Skewed
set.seed(1)
x <- rnorm(100, 5,1); y <- 4.65*x + rnorm(100, 0, 5)
x2 <- rnorm(100, 5, 1); y2 <- 0*x2 + rnorm(100, 0, 3)
xy <- data.frame(x = c(x,x2), y=c(y,y2))
plot(xy$x,xy$y)
scagnostics(xy$x,xy$y)$s[2] #.651


skew.plots <- read_csv("simulation_data/sparse_trend_plots.csv")
skew.test <- subset(skew.plots, skew.plots$ID == 314)
plot(skew.test$x, skew.test$y)
scagnostics(skew.test$x, skew.test$y)$s[2] #.382

skew.plots2 <- read_csv("simulation_data/turk16_plots.csv")
skew.test2 <- subset(skew.plots2, skew.plots2$ID == 254)
plot(skew.test2$x, skew.test2$y)
scagnostics(skew.test2$x, skew.test2$y)$s[2] #.877

par(mfrow = c(2,2))
plot(skew.test$x, skew.test$y, main = "Skewed: .382", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(xy$x,xy$y, main = "Skewed: .651", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(skew.test2$x, skew.test2$y, main = "Skewed: .877", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
```

```{r, fig.height=4, fig.width=5}
#Clumpy
set.seed(1)
sigma <- matrix(c(.1, 0, 0, .1), 2) 
c1.xy1 <- mvrnorm(100, mu = c(2,2), Sigma = sigma); c1.xy2 <- mvrnorm(100, mu = c(10,4), Sigma = sigma)
clump1.xy <- rbind(c1.xy1, c1.xy2)
scagnostics(clump1.xy[,1], clump1.xy[,2])$s[3] #.900

sigma <- matrix(c(1.3, 0, 0, 1.3), 2)
c2.xy1 <- mvrnorm(100, mu = c(0,4), Sigma = sigma); c2.xy2 <- mvrnorm(100, mu = c(4.5,4), Sigma = sigma)
c2.xy3 <- mvrnorm(100, mu = c(0,9), Sigma = sigma); c2.xy4 <- mvrnorm(100, mu = c(4.5,9), Sigma = sigma)
clump2.xy <- rbind(c2.xy1, c2.xy2, c2.xy3, c2.xy4)
scagnostics(clump2.xy[,1], clump2.xy[,2])$s[3] #.007

sigma <- matrix(c(.6, 0, 0, .6), 2)
c3.xy1 <- mvrnorm(100, mu = c(1,1), Sigma = sigma); c3.xy2 <- mvrnorm(100, mu = c(6,2), Sigma = sigma)
c3.xy3 <- mvrnorm(100, mu = c(4,6), Sigma = sigma)
clump3.xy <- rbind(c3.xy1, c3.xy2, c3.xy3)
scagnostics(clump3.xy[,1], clump3.xy[,2])$s[3]  #.446

par(mfrow = c(2,2))
plot(clump2.xy[,1], clump2.xy[,2], main = "Clumpy: .007", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(clump3.xy[,1], clump3.xy[,2], main = "Clumpy: .446", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(clump1.xy[,1], clump1.xy[,2], main = "Clumpy: .900", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
```

```{r, fig.height=4, fig.width=5}
#Sparse
```

```{r, fig.height=4, fig.width=5}
#Striated
```

```{r, fig.height=4, fig.width=5}
#Convex
```

```{r, fig.height=4, fig.width=5}
#Skinny
```

```{r, fig.height=4, fig.width=5}
#Stringy
set.seed(1)
string1.x <- runif(200,-20,20); string1.y <- string1.x^3 + rnorm(200,0,72)
scagnostics(string1.x, string1.y)$s[8] #.892

string2.x <- runif(100,-10,10); string2.y <- string2.x^4 + rnorm(100, 0, 200)
scagnostics(string2.x, string2.y)$s[8] #.611

string3.xy <- mvrnorm(400, mu = c(0,0), Sigma = matrix(c(3,0,0,3),2))
scagnostics(string3.xy[,1], string3.xy[,2])$s[8] #.363

par(mfrow = c(2,2))
plot(string3.xy[,1], string3.xy[,2], main = "Stringy: .363", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(string2.x, string2.y, main = "Stringy: .611", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")
plot(string1.x, string1.y, main = "Stringy: .892", xlab = "X", ylab = "Y", xaxt = "n", yaxt = "n")


```

```{r, fig.height=4, fig.width=5}
#Monotonic
```

